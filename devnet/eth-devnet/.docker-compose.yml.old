version: '3.8'
services:
  node1:
    build: ./node1
    container_name: node1
    volumes:
      - ./node1/data:/data
    ports:
      - "8545:8545"     # Geth HTTP
      - "8546:8546"     # Geth WS
      - "8551:8551"     # Geth Auth RPC
      - "6060:6060"     # Geth Metrics
      - "30303:30303"   # Geth P2P
      - "13000:13000"   # Beacon Node P2P TCP
      - "12000:12000/udp"   # Beacon Node P2P UDP
      - "4000:4000"     # Beacon Node RPC
      - "3500:3500"     # Beacon Node GRPC Gateway
      - "7000:7000"     # Validator RPC
      - "7500:7500"     # Validator GRPC Gateway
      - "8080:8080"     # Beacon Node Monitoring
      - "8081:8081"     # Validator Monitoring
    networks:
      devnet:
        ipv4_address: 172.20.0.2
  node2:
    build: ./node2
    container_name: node2
    volumes:
      - ./node2/data:/data
    ports:
      - "8547:8547"     # Geth HTTP
      - "8548:8548"     # Geth WS
      - "8553:8553"     # Geth Auth RPC
      - "6061:6061"     # Geth Metrics
      - "30304:30304"   # Geth P2P
      - "13001:13001"   # Beacon Node P2P TCP
      - "12001:12001/udp"   # Beacon Node P2P UDP
      - "4001:4001"     # Beacon Node RPC
      - "3501:3501"     # Beacon Node GRPC Gateway
      - "7001:7001"     # Validator RPC
      - "7501:7501"     # Validator GRPC Gateway
      - "8082:8082"     # Beacon Node Monitoring
      - "8083:8083"     # Validator Monitoring
    networks:
      devnet:
        ipv4_address: 172.20.0.3

networks:
  devnet:
    driver: bridge
    ipam:
      config:
        - subnet: 172.20.0.0/16
